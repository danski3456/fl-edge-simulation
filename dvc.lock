schema: '2.0'
stages:
  download_data:
    cmd: python src/setup/download_dataset.py
    deps:
    - path: src/datasets
      md5: 352228322f49cf7981b2eb736e5c17da.dir
      size: 9770
      nfiles: 6
    - path: src/setup/download_dataset.py
      md5: 1f33bd10e776c5ab04e875d1799e55dc
      size: 163
    params:
      params.yaml:
        dataset_name: mnist
    outs:
    - path: assets/raw_datasets/mnist
      md5: ef50dfefcc25e2e7865d16dfc852a4f2.dir
      size: 133089540
      nfiles: 16
  original_assignment:
    cmd: python src/setup/generate_assignment.py
    deps:
    - path: assets/raw_datasets/mnist
      md5: ef50dfefcc25e2e7865d16dfc852a4f2.dir
      size: 133089540
      nfiles: 16
    - path: src/setup/generate_assignment.py
      md5: 4196d13c38c9921d774b18d31ad599b6
      size: 2398
    params:
      params.yaml:
        arrival_rate:
          type: constant
          quantity: 100
        dataset_name: mnist
        iid: false
        num_clients: 9
        timeslots: 23
    outs:
    - path: assets/original_assignment/mnist/original_assignment.csv
      md5: 8b3a2d32f14af765aacdc24cea58e183
      size: 255501
  final_assignment:
    cmd: python src/policies/apply.py
    deps:
    - path: assets/original_assignment/mnist/
      md5: 5ba979c59ca87aeddc221f9a761fbdb9.dir
      size: 255526
      nfiles: 2
    - path: src/policies/
      md5: e97af9cce2c0d00a1660294987da1006.dir
      size: 16158
      nfiles: 9
    params:
      params.yaml:
        cache_capacity:
          type: constant
          quantity: 500
        dataset_name: mnist
        fl_rounds:
        - 0
        - 1
        - 2
        - 3
        - 4
        - 5
        - 6
        - 7
        - 8
        - 9
        - 10
        - 11
        - 12
        - 13
        - 14
        - 15
        - 16
        - 17
        - 18
        - 19
        num_clients: 9
        timeslots: 23
        topology: ring
    outs:
    - path: assets/final_assignment/mnist/final_assignment.json
      md5: db34c83773e141e6b68c19c597071038
      size: 272802
  simulate:
    cmd: python src/simulations/federated_learning.py && python src/simulations/central_server.py
    deps:
    - path: assets/final_assignment/mnist/
      md5: a731dbe61d69e0c77df9a38bb8c3f92e.dir
      size: 272662
      nfiles: 2
    - path: src/flower/
      md5: 6b948e67eb41962faebd20e8f788f826.dir
      size: 9530
      nfiles: 4
    - path: src/simulations/
      md5: c88ec45df7d00c2bec9b63c9a72d2377.dir
      size: 2406
      nfiles: 2
    params:
      params.yaml:
        dataset_name: mnist
        fl_rounds:
        - 0
        - 1
        - 2
        - 3
        - 4
        - 5
        - 6
        - 7
        - 8
        - 9
        - 10
        - 11
        - 12
        - 13
        - 14
        - 15
        - 16
        - 17
        - 18
        - 19
        model_name: mnist_conv
        num_clients: 9
    outs:
    - path: assets/metrics/train
      md5: e630f6e0f0a24a266f0027dc966cd4f0.dir
      size: 6939
      nfiles: 1
    - path: assets/models/
      md5: 288fa9ee49494e399abc05f15cf64e99.dir
      size: 234452
      nfiles: 2
  report:
    cmd: python src/reports/data_distributions.py && python src/reports/training.py
      && python src/reports/confusion_matrix.py
    deps:
    - path: assets/metrics/train
      md5: 7cb6678ed039bd5d4b1fb280d1c2d254.dir
      size: 2778
      nfiles: 8
    - path: src/reports
      md5: 09c88425269eafa8fa843c631061aa4e.dir
      size: 5224
      nfiles: 3
    params:
      params.yaml:
        dataset_name: mnist
        num_clients: 6
    outs:
    - path: assets/metrics/test/central/metrics.json
      md5: 8f8f5ccfb5ee4b68b00ea5e9c98db960
      size: 39
    - path: assets/metrics/test/federated/metrics.json
      md5: 9993883d021752e0e579d0318260c257
      size: 39
    - path: assets/reports/images/mnist
      md5: f408894851c52923e7fe19a91d215a00.dir
      size: 195449
      nfiles: 5
