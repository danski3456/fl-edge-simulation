schema: '2.0'
stages:
  download_data:
    cmd: python src/setup/download_dataset.py
    deps:
    - path: src/datasets
      md5: 9cdb11c7ca579cf4b83c02b69273ef48.dir
      size: 9770
      nfiles: 6
    - path: src/setup/download_dataset.py
      md5: 1f33bd10e776c5ab04e875d1799e55dc
      size: 163
    params:
      params.yaml:
        dataset_name: mnist
    outs:
    - path: assets/raw_datasets/mnist
      md5: ef50dfefcc25e2e7865d16dfc852a4f2.dir
      size: 133089540
      nfiles: 16
  original_assignment:
    cmd: python src/setup/generate_assignment.py
    deps:
    - path: assets/raw_datasets/mnist
      md5: ef50dfefcc25e2e7865d16dfc852a4f2.dir
      size: 133089540
      nfiles: 16
    - path: src/setup/generate_assignment.py
      md5: 4196d13c38c9921d774b18d31ad599b6
      size: 2398
    params:
      params.yaml:
        arrival_rate:
          type: constant
          quantity: 100
        dataset_name: mnist
        iid: false
        num_clients: 6
        timeslots: 70
    outs:
    - path: assets/original_assignment/mnist/original_assignment.csv
      md5: d1ccab9d224c84dfa2051619460fbd06
      size: 530291
  final_assignment:
    cmd: python src/policies/apply.py
    deps:
    - path: assets/original_assignment/mnist/
      md5: 984eda1a8e8134ccb7129b12e42bc03d.dir
      size: 530316
      nfiles: 2
    - path: src/policies/
      md5: 9c4043ca79627cb2d21a847c368dd9bb.dir
      size: 19758
      nfiles: 11
    params:
      params.yaml:
        cache_capacity:
          type: constant
          quantity: 500
        dataset_name: mnist
        fl_rounds:
          type: all
          freq: 1
        max_resources: 1000
        num_clients: 6
        resources:
          0: first-half
        timeslots: 70
        topology: ring
    outs:
    - path: assets/final_assignment/mnist/final_assignment.json
      md5: f239e5d8611a8d9adb470c9f2a7c0b2a
      size: 589873
  simulate:
    cmd: python src/simulations/federated_learning.py && python src/simulations/central_server.py
    deps:
    - path: assets/final_assignment/mnist/
      md5: 9a1a77a98d49c18a3f0d7df78e995bff.dir
      size: 589896
      nfiles: 2
    - path: src/flower/
      md5: 7385b6320abc622124f5b92ce6c44817.dir
      size: 10131
      nfiles: 4
    - path: src/simulations/
      md5: 5e26e8ee1b6601881655b784360b7e5a.dir
      size: 2156748
      nfiles: 37
    params:
      params.yaml:
        dataset_name: mnist
        fl_rounds:
          type: all
          freq: 1
        model_name: mnist_conv
        num_clients: 6
    outs:
    - path: assets/metrics/train
      md5: 0c461a7494b131cb9d1f79b5af39e426.dir
      size: 102262
      nfiles: 8
    - path: assets/models/
      md5: bec87ce935debec047e707d73a17c064.dir
      size: 234452
      nfiles: 2
  report:
    cmd: python src/reports/data_distributions.py && python src/reports/training.py
      && python src/reports/confusion_matrix.py
    deps:
    - path: assets/metrics/train
      md5: 0c461a7494b131cb9d1f79b5af39e426.dir
      size: 102262
      nfiles: 8
    - path: src/reports
      md5: cb5f1aaa5f98228262d3a5228ae0dce9.dir
      size: 9208
      nfiles: 41
    params:
      params.yaml:
        dataset_name: mnist
        num_clients: 6
    outs:
    - path: assets/metrics/test/central/metrics.json
      md5: 54a7e79e8d3235e5e86cc7336fb439ff
      size: 39
    - path: assets/metrics/test/federated/metrics.json
      md5: fff0ecf997f0aca461b7129ca17275c5
      size: 36
    - path: assets/reports/images/mnist
      md5: d111eef9c06b080e69773cab2fcadc4c.dir
      size: 398762
      nfiles: 6
