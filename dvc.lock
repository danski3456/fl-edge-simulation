schema: '2.0'
stages:
  download_data:
    cmd: python src/setup/download_dataset.py
    deps:
    - path: src/datasets
      md5: 9c0bc16268f8ebd7ccf00fd6b64655e9.dir
      size: 6732
      nfiles: 6
    - path: src/setup/download_dataset.py
      md5: 1f33bd10e776c5ab04e875d1799e55dc
      size: 163
    params:
      params.yaml:
        dataset_name: mnist
    outs:
    - path: assets/raw_datasets/mnist
      md5: ef50dfefcc25e2e7865d16dfc852a4f2.dir
      size: 133089540
      nfiles: 16
  original_assignment:
    cmd: python src/setup/generate_assignment.py
    deps:
    - path: assets/raw_datasets/mnist
      md5: ef50dfefcc25e2e7865d16dfc852a4f2.dir
      size: 133089540
      nfiles: 16
    - path: src/setup/generate_assignment.py
      md5: fe0d75a03559fe925fe2e367eeedabcb
      size: 2393
    params:
      params.yaml:
        arrival_rate:
          type: constant
          quantity: 100
        dataset_name: mnist
        num_clients: 6
        timeslots: 20
    outs:
    - path: assets/original_assignment/mnist/original_assignment.csv
      md5: 7e61c858c5ca40ac1cf309e64fc01403
      size: 147958
  final_assignment:
    cmd: python src/policies/apply.py
    deps:
    - path: assets/original_assignment/mnist/
      md5: 274b694f9d6678ffdadb000a6cd2c8c4.dir
      size: 147983
      nfiles: 2
    - path: src/policies/
      md5: 4efe64929c11fe0e538a7e586b81b821.dir
      size: 13269
      nfiles: 8
    params:
      params.yaml:
        cache_capacity:
          type: constant
          quantity: 500
        dataset_name: mnist
        fl_rounds:
        - 0
        - 1
        - 2
        - 3
        - 4
        - 5
        - 6
        - 7
        - 8
        - 9
        - 10
        - 11
        - 12
        - 13
        - 14
        - 15
        - 16
        - 17
        - 18
        - 19
        num_clients: 6
        timeslots: 20
        topology: none
    outs:
    - path: assets/final_assignment/mnist/final_assignment.json
      md5: 3c317c479234a9a54c7ee2f13a0fc666
      size: 507075
  simulate:
    cmd: python src/simulations/federated_learning.py && python src/simulations/central_server.py
    deps:
    - path: assets/final_assignment/mnist/
      md5: 0b557b5955ddf0f23c25aa3374f1054a.dir
      size: 76978
      nfiles: 2
    - path: src/flower/
      md5: c71d4934e9d664023891e7ddd031e257.dir
      size: 9482
      nfiles: 4
    - path: src/simulations/
      md5: a2367bc794128c48255b9c839e4fe417.dir
      size: 1800304
      nfiles: 33
    params:
      params.yaml:
        dataset_name: mnist
        fl_rounds:
        - 0
        - 5
        - 10
        - 15
        model_name: mnist_conv
        num_clients: 6
    outs:
    - path: assets/metrics/
      md5: 8d6d467a961573a99527f3256042833a.dir
      size: 5151
      nfiles: 8
    - path: assets/models/
      md5: f93451b2e0e8df9535bba7be09013801.dir
      size: 234452
      nfiles: 2
  report:
    cmd: python src/reports/data_distributions.py && python src/reports/training.py
      && python src/reports/confusion_matrix.py
    deps:
    - path: assets/metrics/
      md5: 8d6d467a961573a99527f3256042833a.dir
      size: 5151
      nfiles: 8
    - path: src/reports
      md5: 16244e2cf928fe91837472a55e8b02ad.dir
      size: 6921
      nfiles: 33
    params:
      params.yaml:
        dataset_name: mnist
        num_clients: 6
    outs:
    - path: assets/reports/images/mnist
      md5: 0f1712ef8e59eb9e11c969355bd8abe7.dir
      size: 169541
      nfiles: 5
